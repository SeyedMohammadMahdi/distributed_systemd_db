services:
  go_master:
    image: gopro
    build: .
    ports:
      - "8080:8080"
    environment:
      - NODES=${NODES}
      - ROLE=${ROLE1}
      - TEST=${TEST}
    depends_on:
      - replica1
      - replica2
  replica1:
    image: gopro
    build: .
    environment:
      - NODES=${NODES}
      - ROLE=${ROLE2}
      - TEST=${TEST}
    ports:
      - "8081:8080"
  replica2:
    image: gopro
    build: .
    environment:
      - NODES=${NODES}
      - ROLE=${ROLE3}
      - TEST=${TEST}
    ports:
      - "8082:8080"